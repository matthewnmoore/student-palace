{% extends "base.html" %}
{% block title %}Student Palace – Find rooms{% endblock %}
{% block content %}
<section class="wrap">

  <!-- HERO / INTRO -->
  <div class="card card--accent-edges hero-centered">
    <h1 class="mt-0" style="margin-bottom:6px">Your next student home — without the faff.</h1>
    <p class="muted" style="margin-bottom:0">
      Look out for the ✅ green tick – it means properties from verified landlords and agents.
    </p>
  </div>

  <!-- SEARCH -->
  <div class="card card--accent-edges hero-centered">
    <h2 class="mt-0">Search Student Properties</h2>

    <form action="{{ url_for('public.search') }}" method="get"
          class="grid grid-2 form-compact-labels"
          style="justify-items:center; text-align:center;">

      <!-- City -->
      <label class="field" style="min-width:240px">
        <span class="label-inline">City</span>
        <select name="city">
          <option value="">Any city</option>
          {% for c in cities %}
            <option value="{{ c }}">{{ c }}</option>
          {% endfor %}
        </select>
      </label>

      <!-- Group size -->
      <label class="field" style="min-width:240px">
        <span class="label-inline">Group size</span>
        <select name="group_size">
          <option value="">Any</option>
          {% for n in range(1,10) %}
            <option value="{{ n }}">{{ n }}</option>
          {% endfor %}
        </select>
      </label>

      <!-- Gender wording update -->
      <label class="field" style="min-width:240px">
        <span class="label-inline">I want a house that identifies as</span>
        <select name="gender" required>
          <option value="" selected>Please choose one</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Anything">Anything</option>
        </select>
      </label>

      <!-- Academic Year -->
      <label class="field" style="min-width:240px">
        <span class="label-inline">Academic year</span>
        <select name="academic_year">
          <option value="">Any</option>
          <option value="2025/2026">2025/2026</option>
          <option value="2026/2027">2026/2027</option>
          <option value="2027/2028">2027/2028</option>
          <option value="2028/2029">2028/2029</option>
        </select>
      </label>

      <!-- Preferences row with BIG centered button -->
      <div class="field" style="grid-column:1/-1">
        <span class="label">Preferences</span>
        <div class="prefs-row" style="justify-content:center; align-items:center; gap:18px">
          <label class="check"><input type="checkbox" name="ensuite"> Ensuite / own bathroom</label>

          <!-- Big wide button in the middle -->
          <button class="btn btn-accent btn-lg-wide btn-wide" type="submit">Find rooms</button>

          <label class="check"><input type="checkbox" name="bills_included"> All bills included</label>
        </div>
      </div>
    </form>
  </div>

  <!-- FEATURED + CITY GRID -->
  <div class="card card--accent-edges">
    <h2 class="mt-0">Featured this week</h2>
    <p class="muted">A popular pick in {{ cities[0] if cities else 'Cardiff' }}.</p>

    {% if cities_with_meta and cities_with_meta|length %}
      <div class="city-grid" style="margin-top:12px">
        {% for c in cities_with_meta %}
          <a class="city-card" href="{{ url_for('public.search') }}?city={{ c.name|urlencode }}">
            {% if c.image_url %}
              <div class="city-thumb" style="background-image:url('{{ c.image_url }}')">
                <span class="city-name">{{ c.name }}</span>
              </div>
            {% else %}
              <div class="city-thumb city-thumb--placeholder">
                <span class="city-initial">{{ c.name[:1] }}</span>
                <span class="city-name">{{ c.name }}</span>
              </div>
            {% endif %}
          </a>
        {% endfor %}
      </div>
    {% endif %}

    <div class="inline-actions" style="margin-top:16px">
      <a class="btn" href="{{ url_for('public.search') }}">Browse all</a>
      <a class="btn btn-outline" href="{{ url_for('public.index') }}">Back to home</a>
    </div>
  </div>

</section>
{% endblock %}
